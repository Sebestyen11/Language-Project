<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<title>Language Tree</title>
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<style>
body {
  margin:0;
  font-family:"Segoe UI", Arial, sans-serif;
  background: linear-gradient(135deg,#f3f7fa,#e0ebf5);
  overflow:hidden;
  user-select:none;
}
#tree-container { width:100vw; height:100vh; touch-action:none; cursor:grab; }
svg { width:100%; height:100%; }
#tree-group { transition: transform 0.05s linear; }
.node rect {
  fill:#fff; stroke:#5b9bd5; stroke-width:2; rx:8; ry:8;
  filter: drop-shadow(0 2px 4px rgba(0,0,0,0.1));
}
.node:hover rect { fill:#e6f3ff; stroke:#0078d4; transform:scale(1.05); }
.node text { font-size:14px; font-weight:500; fill:#333; pointer-events:none; }
path.link { stroke:#a0bcd0; stroke-width:2; fill:none; }
.popup {
  position:fixed; top:50%; left:50%; transform:translate(-50%,-50%);
  background:#fff; border-radius:12px; padding:20px 25px;
  box-shadow:0 6px 20px rgba(0,0,0,0.25); display:none;
  z-index:1001; max-width:400px; text-align:center;
}
.popup h2 { margin-top:0; color:#0078d4; }
.popup p { color:#444; }
.popup .close {
  position:absolute; top:8px; right:12px;
  font-size:22px; font-weight:bold; color:#0078d4; cursor:pointer;
}
.overlay {
  position:fixed; top:0; left:0; width:100%; height:100%;
  background: rgba(0,0,0,0.4); display:none; z-index:1000;
}
</style>
</head>
<body>

<div id="tree-container">
  <svg id="tree-svg"><g id="tree-group"></g></svg>
</div>

<div class="overlay" id="overlay"></div>

<div class="popup" id="popup">
  <span class="close" id="closePopup">&times;</span>
  <h2 id="popupTitle"></h2>
  <p id="popupInfo"></p>
</div>

<script>
// ---------------- Data ----------------
const data=[
  {name:"Indo-European", info:"Major family including Europe and South Asia."},
  {name:"Uralic", info:"Includes Finnish, Estonian, Hungarian."}
];

// ---------------- Elements ----------------
const svg=document.getElementById("tree-svg");
const group=document.getElementById("tree-group");
const overlay=document.getElementById("overlay");
const popup=document.getElementById("popup");
const popupTitle=document.getElementById("popupTitle");
const popupInfo=document.getElementById("popupInfo");
const closePopup=document.getElementById("closePopup");

// ---------------- Layout ----------------
const width=svg.clientWidth, height=svg.clientHeight;
function layout(data){
  const nodes=[];
  data.forEach((root,i)=>{
    const x = width/2 + (i===0?-150:150); // two groups centered horizontally
    const y = 100;
    root.x = x; root.y = y; nodes.push(root);
  });
  return nodes;
}

// ---------------- Draw ----------------
function draw(){
  group.innerHTML="";
  const nodes=layout(data);
  nodes.forEach(n=>{
    const g=document.createElementNS("http://www.w3.org/2000/svg","g");
    g.setAttribute("class","node"); g.setAttribute("transform",`translate(${n.x},${n.y})`);
    g.dataset.name=n.name; g.dataset.info=n.info;
    const rect=document.createElementNS("http://www.w3.org/2000/svg","rect");
    rect.setAttribute("x",-70); rect.setAttribute("y",-25); rect.setAttribute("width",140); rect.setAttribute("height",50);
    const text=document.createElementNS("http://www.w3.org/2000/svg","text");
    text.setAttribute("text-anchor","middle"); text.setAttribute("dy","5"); text.textContent=n.name;
    g.appendChild(rect); g.appendChild(text); group.appendChild(g);
    g.addEventListener("click", e=>{
      e.stopPropagation(); showPopup(n.name,n.info);
    });
  });
}
draw();

// ---------------- Popup ----------------
function showPopup(title,info){ popupTitle.textContent=title; popupInfo.textContent=info; popup.style.display="block"; overlay.style.display="block";}
function hidePopup(){ popup.style.display="none"; overlay.style.display="none";}
closePopup.onclick=hidePopup; overlay.onclick=hidePopup;

// ---------------- Intro Popup ----------------
window.addEventListener("load", ()=>{
  showPopup("Welcome to the Language Tree", "This interactive tree shows the main language families. Click on a group to learn more. You can drag the tree and zoom in/out.");
});

// ---------------- Drag & Smooth Zoom ----------------
let panX=0, panY=0, scale=1;
let dragging=false, startX, startY;

function updateTransform(){ group.setAttribute("transform",`translate(${panX},${panY}) scale(${scale})`); }

// Mouse wheel zoom (smooth)
svg.addEventListener("wheel", e=>{
  if(popup.style.display==="block") return;
  e.preventDefault();
  const rect = svg.getBoundingClientRect();
  const cx = e.clientX - rect.left;
  const cy = e.clientY - rect.top;

  const factor = e.deltaY < 0 ? 1.05 : 0.95;
  panX -= (cx - panX)*(factor-1);
  panY -= (cy - panY)*(factor-1);
  scale *= factor;
  scale = Math.max(0.5, Math.min(scale,3));
  updateTransform();
});

// Drag (solid)
svg.addEventListener("mousedown", e=>{
  if(popup.style.display==="block") return;
  dragging=true; startX=e.clientX-panX; startY=e.clientY-panY; svg.style.cursor="grabbing";
});
window.addEventListener("mousemove", e=>{if(dragging){ panX=e.clientX-startX; panY=e.clientY-startY; updateTransform(); }});
window.addEventListener("mouseup", ()=>{ dragging=false; svg.style.cursor="grab"; });

// Touch pan and pinch zoom
let lastTouchDist=null, lastTouchMidX=0, lastTouchMidY=0;
svg.addEventListener("touchstart", e=>{
  if(popup.style.display==="block") return;
  if(e.touches.length===1){ dragging=true; startX=e.touches[0].clientX-panX; startY=e.touches[0].clientY-panY; }
  else if(e.touches.length===2){
    lastTouchDist=Math.hypot(e.touches[0].clientX-e.touches[1].clientX,e.touches[0].clientY-e.touches[1].clientY);
    lastTouchMidX=(e.touches[0].clientX+e.touches[1].clientX)/2;
    lastTouchMidY=(e.touches[0].clientY+e.touches[1].clientY)/2;
  }
});
svg.addEventListener("touchmove", e=>{
  if(popup.style.display==="block") return;
  e.preventDefault();
  if(e.touches.length===1 && dragging){ panX=e.touches[0].clientX-startX; panY=e.touches[0].clientY-startY; updateTransform(); }
  else if(e.touches.length===2){
    const dist=Math.hypot(e.touches[0].clientX-e.touches[1].clientX,e.touches[0].clientY-e.touches[1].clientY);
    if(lastTouchDist){
      const factor=dist/lastTouchDist;
      panX -= (lastTouchMidX-panX)*(factor-1);
      panY -= (lastTouchMidY-panY)*(factor-1);
      scale*=factor; scale=Math.max(0.5, Math.min(scale,3));
      updateTransform();
    }
    lastTouchDist=dist;
  }
});
svg.addEventListener("touchend", e=>{ if(e.touches.length<2) lastTouchDist=null; if(e.touches.length===0) dragging=false; });
</script>
</body>
</html>